const App=()=>{var e=[["ar","Arabic"],["bn","Bengali (Bangla)"],["bh","Bihari"],["zh","Chinese"],["zh-Hans","Chinese (Simplified)"],["zh-Hant","Chinese (Traditional)"],["cs","Czech"],["nl","Dutch"],["en-US","English (US)"],["en-UK","English (UK)"],["fr","French"],["el","Greek"],["gu","Gujarati"],["hi","Hindi"],["id","Indonesian"],["it","Italian"],["ja","Japanese"],["la","Latin"],["ne","Nepali"],["pl","Polish"],["pt","Portuguese"],["pa","Punjabi (Eastern)"],["ru","Russian"],["sa","Sanskrit"],["es","Spanish"],["sv","Swedish"],["ta","Tamil"],["te","Telugu"],["th","Thai"],["bo","Tibetan"],["tr","Turkish"],["uk","Ukrainian"],["ur","Urdu"],["vi","Vietnamese"],["zu","Zulu"]];const a={lang:e,langSelected:9,onLoadShowGuide:!0,refs:{outputCon:outputCon,messsCon:messsCon,toastCon:toastCon,selectLang:selectLang,startBtn:startBtn,resetBtn:resetBtn,helpBtn:helpBtn,guideCon:guideCon,guideCloseBtn:guideCloseBtn,currentPara:{p:null,listened:null,listening:null}},srConfigDefault:{interimResults:!0,continuous:!1,maxAlternatives:1,lang:e[9][0]},toast:(e,t=2e3)=>{const n=document.createElement("div");n.classList.add("message","active");let r=document.createElement("div");r.classList.add("text"),r.append(e),n.append(r),a.refs.toastCon.append(n),setTimeout(()=>{var t=""===a.refs.toastCon.style.top?0:Number(a.refs.toastCon.style.top.slice(0,-2));const n=a.refs.toastCon.children[0];if(n){var r=n.getBoundingClientRect();let e=getComputedStyle(n);var s=Number(e.paddingTop.slice(0,-2)),i=Number(e.paddingBottom.slice(0,-2)),s=t-(r.height-s-i+s);a.refs.toastCon.style.top=s+"px",setTimeout(()=>{a.refs.toastCon.getBoundingClientRect().bottom-a.refs.messsCon.getBoundingClientRect().top<10&&(a.refs.toastCon.innerHTML=null,a.refs.toastCon.style.top="0px")},700)}},t)}};return a.fun=(()=>{const i={addPara:()=>{const t=a.refs.outputCon.querySelectorAll("p.selected");if(0<t.length)for(let e=0;e<t.length;e++)t[e].classList.remove("selected");const e=document.createElement("p");e.classList.add("selected");const n=document.createElement("span"),r=document.createElement("span"),s=document.createElement("span");return n.classList.add("listened"),r.innerText=" ",s.classList.add("listening"),s.innerHTML="<br>",e.append(n,r,s),a.refs.currentPara.p=e,a.refs.currentPara.listened=n,a.refs.currentPara.listening=s,a.refs.outputCon.append(e),e.addEventListener("click",i.selectPara),a.refs.outputCon.addEventListener("keydown",i.paraOnKeyDown),i.setCursor(),{p:e,listened:n,listening:s}},selectPara:e=>{},paraOnKeyDown:e=>{"enter"===e.key.toLowerCase()&&(e.preventDefault(),a.fun.addPara())},setCursor:()=>{},setupControls:()=>{console.log(a.refs.selectLang),a.refs.selectLang.append(...a.lang.map((e,t)=>{const n=document.createElement("option");return n.innerText=e[1],n.value=t,a.langSelected===t&&n.setAttribute("selected",!0),n})),a.refs.selectLang.addEventListener("change",e=>{e=+e.target.value;const t=a.refs.selectLang.querySelectorAll("option[selected]");var n=t.length;for(let e=0;e<n;e++)t[e].removeAttribute("selected");a.refs.selectLang.children[e].setAttribute("selected",!0),a.sr.instance.lang=a.lang[e][0],a.sr.stop(),setTimeout(()=>{a.sr.start()},200)}),a.refs.startBtn.innerText=a.sr.listening?"Stop":"Start",a.refs.startBtn.addEventListener("click",e=>{console.log(e),a.sr.listening?(a.sr.stop(),a.refs.startBtn.innerText="Start"):(a.sr.start(),a.refs.startBtn.innerText="Stop")}),a.refs.resetBtn.addEventListener("click",e=>{window.location.href="/"}),a.refs.helpBtn.addEventListener("click",e=>{a.guide.show()}),a.refs.guideCloseBtn.addEventListener("click",e=>{a.guide.hide()})}};return i})(),a.sr=(()=>{const s={instance:null,listening:!1,transcriptTextArray:[],cmds:{},createInstance:()=>{for(var e=["SpeechRecognition","webkitSpeechRecognition","mozSpeechRecognition","msSpeechRecognition","oSpeechRecognition"],t=0;t<e.length;t++)if(e[t]in window){switch(s.srAPItype=e[t],e[t]){case"SpeechRecognition":s.instance=new SpeechRecognition;break;case"webkitSpeechRecognition":s.instance=new webkitSpeechRecognition;break;case"mozSpeechRecognition":s.instance=new mozSpeechRecognition;break;case"msSpeechRecognition":s.instance=new SpeechRecognition;break;case"oSpeechRecognition":s.instance=new oSpeechRecognition;break;default:s.instance=null}if(null!==s.instance){for(const n in a.srConfigDefault)s.instance[n]=a.srConfigDefault[n];s.instance.onend=()=>{if(console.log("end"),""!==a.refs.currentPara.listening.innerText){const t=a.refs.currentPara.listened.innerText;let e=a.refs.currentPara.listening.innerText;s.cmds[e.toLowerCase()]?s.cmds[e.toLowerCase()]():"<br>"!==a.refs.currentPara.listening.innerHTML&&(0!==t.length&&"."!==t.slice(-1)||(e=e.slice(0,1).toUpperCase()+e.slice(1)),s.transcriptTextArray.push(e),a.refs.currentPara.listened.innerText+=(0<t.length?" ":"")+e,a.refs.currentPara.listening.innerText=""),a.fun.setCursor()}s.listening&&s.instance.start()},s.instance.onresult=e=>{e=e.results[0][0].transcript;null!==e&&""!==e&&(a.refs.currentPara.listening.innerText=e)}}return s.cmds["cut cut"]=()=>{var e;0<s.transcriptTextArray.length?(e=s.transcriptTextArray.pop(),e=a.refs.currentPara.listened.innerText.slice(0,-e.length).trim(),a.refs.currentPara.listened.innerText=e,a.refs.currentPara.listening.innerHTML=0===e.length?"<br>":null):(a.refs.currentPara.listened.innerText=null,a.refs.currentPara.listening.innerHTML="<br>")},s.cmds["next line"]=()=>{if(0<s.transcriptTextArray.length){const e=a.refs.currentPara.listened.innerText.trim();"."!==e.slice(-1)&&(a.refs.currentPara.listened.innerText+="."),a.refs.currentPara.listening.innerHTML=null}else a.refs.currentPara.listened.innerText=null,a.refs.currentPara.listening.innerHTML="<br>";s.transcriptTextArray=[],a.fun.addPara(),a.refs.outputCon.scrollTo(0,a.refs.outputCon.scrollHeight)},s.cmds["full stop"]=()=>{0<s.transcriptTextArray.length?(a.refs.currentPara.listened.innerText=a.refs.currentPara.listened.innerText.trim()+".",a.refs.currentPara.listening.innerHTML=null):(a.refs.currentPara.listened.innerText=null,a.refs.currentPara.listening.innerHTML="<br>")},s.cmds["copy text"]=()=>{0<s.transcriptTextArray.length?a.refs.currentPara.listening.innerHTML=null:(a.refs.currentPara.listened.innerText=null,a.refs.currentPara.listening.innerHTML="<br>");let t="";var n=a.refs.outputCon.querySelectorAll("span.listened"),r=n.length;for(let e=0;e<r;e++)t+=n[e].innerText+"\n";navigator.clipboard.writeText(t).then(()=>{a.toast("Copied as Plain Text")})},void(s.cmds["copy html"]=()=>{0<s.transcriptTextArray.length?a.refs.currentPara.listening.innerHTML=null:(a.refs.currentPara.listened.innerText=null,a.refs.currentPara.listening.innerHTML="<br>");let t="";var n=a.refs.outputCon.querySelectorAll("span.listened"),r=n.length;for(let e=0;e<r;e++)t+="<p>"+n[e].innerText+"</p>\n";navigator.clipboard.writeText(t).then(()=>{a.toast("Copied as HTML")})})}},start:()=>{s.listening=!0,s.instance.start()},stop:()=>{s.listening=!1,s.instance.abort(),s.instance.stop()}};return null===s.instance&&s.createInstance(),s})(),a.guide=(()=>{const e={isVisible:"false"!==window.localStorage.getItem("onLoadShowGuide"),show:()=>{a.refs.guideCon.classList.add("show")},hide:()=>{a.refs.guideCon.classList.remove("show"),"false"!==window.localStorage.getItem("onLoadShowGuide")&&window.localStorage.setItem("onLoadShowGuide","false")}};return e.isVisible?e.show():e.hide(),e})(),a.init=()=>{a.refs.outputCon.innerHTML=null,a.fun.setupControls(),a.fun.addPara()},a},testing=(()=>{const e={toast:()=>{const e=App();return console.log(e),e.toast("Hello 1"),setTimeout(()=>{e.toast("Hello 2"),setTimeout(()=>{e.toast("Hello 3"),setTimeout(()=>{e.toast("Hello 4")},1e3)},1e3)},1e3),console.log(e),e},addPara:()=>{const e=App();return console.log(e),e.init(),e}};return e})(),app=testing.addPara();